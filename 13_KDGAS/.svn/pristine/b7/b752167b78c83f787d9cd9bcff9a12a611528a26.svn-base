//
//  ImageViewController.m
//  mfinity-consumer
//
//  Created by Jun HyungPark on 2015. 6. 12..
//  Copyright (c) 2015ë…„ DBValley. All rights reserved.
//

#import "ImageViewController.h"
#import "AppDelegate.h"
@interface ImageViewController ()

@end

@implementation ImageViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view.
    self.navigationController.navigationBarHidden = NO;
    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    self.navigationController.navigationBar.barTintColor = [appDelegate myRGBfromHex:appDelegate.naviBarColor];
    UILabel *_label = [[UILabel alloc]initWithFrame:CGRectMake(0, 0, 180, 44)];
    _label.textColor = [appDelegate myRGBfromHex:appDelegate.naviFontColor];
    _label.text = @"Image View";
    _label.font = [UIFont boldSystemFontOfSize:20.0];
    _label.backgroundColor = [UIColor clearColor];
    _label.textAlignment = NSTextAlignmentCenter;
    if ([appDelegate.naviIsShadow isEqualToString:@"Y"]) {
        _label.shadowOffset = CGSizeMake([appDelegate.naviShadowOffset floatValue], [appDelegate.naviShadowOffset floatValue]);
        _label.shadowColor = [appDelegate myRGBfromHex:appDelegate.naviShadowColor];
    }
    self.navigationController.navigationBar.tintColor = [appDelegate myRGBfromHex:appDelegate.naviFontColor];
    self.navigationItem.titleView = _label;
    CGRect screen = [[UIScreen mainScreen]bounds];
    CGFloat screenWidth = screen.size.width;
    
    
    
    NSData *imageData = [NSData dataWithContentsOfFile:_imagePath];
    UIImage *oldImage =[UIImage imageWithData:imageData];
    
    //oldImage.size.height/oldImage.size.width*screenWidth
    UIImage *image = [self resizedImage:oldImage inRect:CGRectMake(0, 0, screenWidth, oldImage.size.height/oldImage.size.width*screenWidth)];
    NSLog(@"width : %f",screenWidth);
    NSLog(@"height : %f",oldImage.size.height/oldImage.size.width*screenWidth);
    
    
    _imageView.image = image;
    
    
    _scrollView.maximumZoomScale = 5.0f;
    
    _scrollView.clipsToBounds = YES;
    
    CGRect frame = _scrollView.frame;
    float imgFactor = frame.size.height / frame.size.width;
    frame.size.width = [[UIScreen mainScreen] bounds].size.width;
    frame.size.height = frame.size.width * imgFactor;
    _scrollView.frame = frame;
    _scrollView.contentSize = _imageView.bounds.size;

    [_scrollView setZoomScale:_scrollView.bounds.size.width/_imageView.bounds.size.width animated:NO];
    

}
-(UIImage *) resizedImage:(UIImage *)img inRect:(CGRect)frameRect {
    UIGraphicsBeginImageContext(frameRect.size);
    [img drawInRect:frameRect];
    return UIGraphicsGetImageFromCurrentImageContext();
}
-(void)viewWillDisappear:(BOOL)animated{
    [super viewWillDisappear:animated];
    self.navigationController.navigationBarHidden = YES;
}
- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}
-(UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView{
    return _imageView;
}

/*
#pragma mark - Navigation

// In a storyboard-based application, you will often want to do a little preparation before navigation
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    // Get the new view controller using [segue destinationViewController].
    // Pass the selected object to the new view controller.
}
*/

@end
