//
//  ChatViewController.h
//  mfinity_sns
//
//  Created by hilee on 2017. 4. 21..
//  Copyright © 2017년 com.dbvalley. All rights reserved.
//

#import <UIKit/UIKit.h>
#import <CoreLocation/CoreLocation.h>
#import <MessageUI/MessageUI.h>
#import <AVFoundation/AVAudioSession.h>
#import "JSQMessagesInputToolbar.h"
#import "ChatMessageData.h"
#import "AppDelegate.h"

#import "ChatListViewController.h"
#import "MFURLSessionUpload.h"
#import "MFURLSession.h"

#import "AMQPChannel.h"
#import "AMQPConnection.h"
#import "AMQPExchange.h"
#import "AMQPQueue.h"
#import "AMQPConsumer.h"
#import "AMQPConsumerThread.h"
#import "AMQPMessage.h"
#import "amqp_framing.h"
#import "amqp.h"
#import <sqlite3.h>

#import <Photos/Photos.h>
#import "JTSImageViewController.h"
#import "NSIndexSet+Convenience.h"
#import "MFTextView.h"



@interface ChatViewController : UIViewController <JSQMessagesInputToolbarDelegate, UITextViewDelegate, UITableViewDataSource, UITableViewDelegate, MFURLSessionDelegate, UIImagePickerControllerDelegate, MFURLSessionUploadDelegate, UINavigationControllerDelegate, UIScrollViewDelegate, NSURLConnectionDataDelegate, NSURLSessionDelegate,
UISearchControllerDelegate, UISearchBarDelegate, UISearchControllerDelegate, UIGestureRecognizerDelegate, MFMessageComposeViewControllerDelegate, MFTextViewDelegate>{
    int uploadCount;
    
    BOOL isRefresh;
    BOOL isDragging;
    
    int rowCnt;
    int selectCount;
    
    BOOL isHideKeyboard;
    BOOL isSmallContents;
    BOOL isLargeContents;
}

@property (strong, nonatomic) IBOutlet UITableView *tableView;
@property (strong, nonatomic) IBOutlet JSQMessagesInputToolbar *inputToolbar;
@property (strong, nonatomic) IBOutlet NSLayoutConstraint *keyboardHeight;

@property (strong, nonatomic) NSString *roomName;
@property (strong, nonatomic) NSString *roomNo;
@property (strong, nonatomic) NSString *roomNoti;

@property (strong, nonatomic) AMQPConnection *connection;

@property (strong, nonatomic) UIButton *mediaButton;
@property BOOL isFlag;

@property (strong, nonatomic) NSMutableArray *contentImageArray;
@property (strong, nonatomic) NSMutableArray *imageArray;
@property (strong, nonatomic) NSMutableArray *imageIndexArray;
@property (strong, nonatomic) NSMutableArray *imageFileNameArray;

@property (strong, nonatomic) NSDictionary *rmqPushDic;

@property (nonatomic, strong) NSString *DBName;
@property (nonatomic, strong) NSString *DBPath;

@property (strong, nonatomic) NSMutableArray *array;
@property (strong, nonatomic) NSString *recvRoomNo;
@property (strong, nonatomic) NSString *recvRoomNm;
@property (strong, nonatomic) NSMutableArray *tempArr;

@property (nonatomic,strong) NSMutableArray *dataSetArray;

@property (strong, nonatomic) NSMutableArray *missedArr;

@property (nonatomic, strong) PHFetchResult *assetsFetchResults;
@property (nonatomic, strong) PHAssetCollection *assetCollection;
@property (nonatomic, strong) PHCachingImageManager *imageManager;
@property (nonatomic, strong) UIImage *missedimg;
@property (nonatomic,strong) NSMutableArray *mImgArray;
@property (nonatomic,strong) NSString *imageStr;

@property (nonatomic, strong) PHAsset *asset;
@property (strong, nonatomic) NSMutableArray *assetArray;

@property (nonatomic,strong) NSMutableDictionary *imageDictionary;
@property (nonatomic,strong) NSMutableDictionary *imageThumbDictionary;

@property (nonatomic,strong) NSString *fromSegue;
@property (nonatomic,strong) NSDictionary *notiChatDic;

@property (nonatomic,strong) NSMutableDictionary *sendImgInfoDic;
@property (nonatomic,strong) NSMutableDictionary *editInfoDic;
@property (nonatomic,strong) NSMutableArray *sendingMsgArr;
@property (nonatomic,strong) NSMutableArray *tmpSendingArr;

@property (strong, nonatomic) NSDictionary *paramDictionary2;
@property (nonatomic,strong) NSMutableArray *postArr;

@property (strong, nonatomic) NSString *tabImgUser;
@property (strong, nonatomic) NSString *tabImgDate;

@property (nonatomic,strong) NSMutableArray *fileNameArr;

-(void)searchChatContent: (NSString *)text;
-(void)closeSearchChat;
@property (strong, nonatomic) NSString *searchText;

@property (strong, nonatomic) NSDictionary *snsInfoDic;

-(void)chatReadTest;

@end
